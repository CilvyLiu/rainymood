<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Nova's Pensieve</title>
    <style>
        /* 1. åŸºç¡€æ ·å¼ä¼˜åŒ– */
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background-color: #0a0a0a; /* æ”¹ä¸ºææ·±ç°ï¼Œç¡®è®¤é¡µé¢å·²åŠ è½½ */
            color: white; overflow: hidden; font-family: serif; 
        }
        
        #bg-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            transition: all 1.2s ease-in-out;
            background-repeat: no-repeat;
            background-position: center;
            z-index: -3;
            /* åˆå§‹å ä½èƒŒæ™¯ */
            background-color: #000;
        }

        #mask {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -2; transition: 0.5s;
        }

        /* 2. å¼ºåŒ–é›¨ç‚¹å±‚ï¼šä½¿ç”¨æœ¬åœ° stardust.png å¹¶å¢åŠ å¤‡ç”¨å™ªç‚¹ */
        #rain-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url("./stardust.png");
            background-repeat: repeat;
            opacity: 0.3;
            pointer-events: none;
            z-index: -1;
            filter: contrast(150%); /* å¢åŠ å¯¹æ¯”åº¦è®©é›¨ç‚¹æ›´æ˜æ˜¾ */
        }

        /* 3. UI å¸ƒå±€ */
        .container {
            display: flex; flex-direction: column; align-items: center;
            justify-content: space-between; height: 100vh; padding: 30px 0;
            box-sizing: border-box; z-index: 10;
        }

        .nav-grid {
            display: grid; grid-template-columns: repeat(4, 1fr);
            gap: 15px; width: 90%; max-width: 800px;
        }
        .nav-card {
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px; padding: 15px;
            text-align: center; text-decoration: none; color: white;
            backdrop-filter: blur(8px); transition: 0.3s;
        }
        .nav-card:hover { border-color: #00d4ff; background: rgba(0, 212, 255, 0.1); }

        .audio-controls {
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 25px; border-radius: 40px;
            display: flex; align-items: center; gap: 20px;
            border: 1px solid rgba(255,255,255,0.15);
        }
        input[type=range] { accent-color: #00d4ff; cursor: pointer; }

        .scene-switcher { display: flex; gap: 8px; margin-top: 15px; flex-wrap: wrap; justify-content: center; }
        button {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
            color: white; padding: 8px 16px; border-radius: 20px; cursor: pointer;
        }
        button:active { transform: scale(0.95); }
    </style>
</head>
<body onclick="initAudio()">

    <div id="bg-layer"></div>
    <div id="mask"></div>
    <div id="rain-overlay"></div>

    <div class="container">
        <div style="text-align: center;">
            <h1 style="letter-spacing: 12px; opacity: 0.8; margin: 0; font-size: 24px;">THE PENSIEVE</h1>
            <p id="clock" style="color: #666; font-size: 12px; margin-top: 5px;"></p>
        </div>

        <div class="nav-grid">
            <a href="https://gringott.streamlit.app/" target="_blank" class="nav-card"><h3>ğŸ¦</h3><div style="font-size:12px;">å¤çµé˜</div></a>
            <a href="https://wwskygazer.streamlit.app/" target="_blank" class="nav-card"><h2>ğŸ¾</h2><div style="font-size:12px;">å—…å—…æ¢æµ‹</div></a>
            <a href="https://newscil.streamlit.app/" target="_blank" class="nav-card"><h2>ğŸ“œ</h2><div style="font-size:12px;">é¢„è¨€æ—¥æŠ¥</div></a>
            <a href="https://skygazer111.streamlit.app/" target="_blank" class="nav-card"><h2>ğŸ”®</h2><div style="font-size:12px;">æˆ˜ç•¥çœ‹æ¿</div></a>
        </div>

        <div style="display: flex; flex-direction: column; align-items: center;">
            <div class="audio-controls">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <span>ğŸ”Š</span>
                    <input type="range" id="volSlider" min="0" max="1" step="0.05" value="0.5" oninput="updateAudio()">
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                    <span>ğŸŒ§ï¸</span>
                    <input type="range" id="rainSlider" min="0" max="1" step="0.05" value="0.3" oninput="updateRain()">
                </div>
                <button onclick="toggleAudio(event)" id="playBtn" style="min-width: 100px;">ğŸ”‡ å¼€å¯éŸ³é¢‘</button>
            </div>

            <div class="scene-switcher">
                <button onclick="setScene('./pensive.png', '450px', 0.85)">ğŸº å†¥æƒ³ç›†</button>
                <button onclick="setScene('./train.png', 'cover', 0.5)">ğŸš‚ ç«è½¦</button>
                <button onclick="setScene('./window.png', 'cover', 0.5)">ğŸªŸ è½åœ°çª—</button>
                <button onclick="setScene('./beach.png', 'cover', 0.5)">ğŸ–ï¸ æ²™æ»©</button>
                <button onclick="setScene('./mountain.png', 'cover', 0.5)">â›°ï¸ å±±é¡¶</button>
            </div>
        </div>
    </div>

    <audio id="rainAudio" loop src="./0.m4a"></audio>

    <script>
        const audio = document.getElementById('rainAudio');
        const bgLayer = document.getElementById('bg-layer');
        const mask = document.getElementById('mask');
        const rainOverlay = document.getElementById('rain-overlay');
        const playBtn = document.getElementById('playBtn');

        // æ ¸å¿ƒåœºæ™¯åˆ‡æ¢å‡½æ•°
        function setScene(img, size, brightness) {
            console.log("æ­£åœ¨å°è¯•åŠ è½½èƒŒæ™¯:", img);
            bgLayer.style.backgroundImage = "url('" + img + "')";
            bgLayer.style.backgroundSize = size;
            mask.style.backgroundColor = "rgba(0, 0, 0, " + brightness + ")";
        }

        function initAudio() {
            if (audio.paused) {
                audio.play().then(() => {
                    playBtn.innerText = "ğŸ”Š æ’­æ”¾ä¸­";
                }).catch(e => console.log("ç­‰å¾…äº¤äº’..."));
            }
        }

        function updateAudio() {
            audio.volume = document.getElementById('volSlider').value;
        }

        function toggleAudio(e) {
            if(e) e.stopPropagation();
            if (audio.paused) {
                audio.play();
                playBtn.innerText = "ğŸ”Š æ’­æ”¾ä¸­";
            } else {
                audio.pause();
                playBtn.innerText = "ğŸ”‡ å·²åœæ­¢";
            }
        }

        function updateRain() {
            rainOverlay.style.opacity = document.getElementById('rainSlider').value;
        }

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleString('zh-CN', {timeZone: 'Asia/Shanghai'}) + " CST";
        }

        // åˆå§‹åŒ–
        window.onload = function() {
            setScene('./pensive.png', '450px', 0.85);
            setInterval(updateClock, 1000);
            updateClock();
            console.log("é¡µé¢åˆå§‹åŒ–å®Œæˆ");
        };
    </script>
</body>
</html>

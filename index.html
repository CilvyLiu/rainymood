<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Nova's Pensieve - WebGL Ultra</title>
    <link rel="stylesheet" href="rain.css">
</head>
<body onclick="initAudio()">

    <div id="container" style="width:100%; height:100%; position:fixed;"></div>
    <div id="overlay"></div>

    <div class="side-nav">
        <a href="https://gringott.streamlit.app/" target="_blank" class="nav-item">ğŸ¦</a>
        <a href="https://wwskygazer.streamlit.app/" target="_blank" class="nav-item">ğŸ¾</a>
        <a href="https://newscil.streamlit.app/" target="_blank" class="nav-item">ğŸ“œ</a>
        <a href="https://skygazer111.streamlit.app/" target="_blank" class="nav-item">ğŸ”®</a>
    </div>

    <div class="center-container">
        <div class="rule-card" id="mainRule">
            <h2>çœ‹æ¿çºªå¾‹</h2>
            <p>
                <b>å£¹ Â· æ·±æ½œ</b>ï¼šå…¥å†¥æƒ³ç›†ï¼Œå¦‚æ°´æ»´èå…¥æ·±æ½­ã€‚<br>
                <b>è´° Â· ç²¾å‡†</b>ï¼šé€»è¾‘å¦‚å†°æ™¶ç¢è£‚ï¼Œæ•°æ®çš†æœ‰å› æœã€‚<br>
                <b>å Â· éŸ§æ€§</b>ï¼šçºµä½¿é›¨å¹•é®çœ¼ï¼Œäº¦è¦æ”«å–è¶‹åŠ¿ã€‚<br>
                <b>è‚† Â· è¿›åŒ–</b>ï¼šæ—¥æ‹±ä¸€å’ï¼Œä»¥æ­¤èº«ç‚¼å°±ç ´å±€ä¹‹æ³•ã€‚
            </p>
        </div>
        <button class="magic-btn" onclick="toggleRules(event)">FOCUS MODE</button>
    </div>

    <div class="bottom-bar">
        <div id="clock">00:00:00</div>
        <label>VOLUME</label> <input type="range" id="vol" min="0" max="1" step="0.1" value="0.5" oninput="sync()">
        
        <select id="weatherSelect" onchange="changeWeather()">
            <option value="rain">ğŸŒ§ï¸ ç»†é›¨</option>
            <option value="storm">â›ˆï¸ æš´é›¨</option>
            <option value="drizzle">ğŸŒ¦ï¸ é˜µé›¨</option>
            <option value="sunny">â˜€ï¸ æ™´æœ—</option>
        </select>

        <select id="sceneSelect" onchange="changeScene()">
            <option value="pensive.png">ğŸº å†¥æƒ³ç›†</option>
            <option value="train.png">ğŸš‚ éœæ ¼æ²ƒèŒ¨</option>
            <option value="window.png">ğŸªŸ è½åœ°çª—</option>
            <option value="beach.png">ğŸ–ï¸ è´å£³å°å±‹</option>
            <option value="mountain.png">ğŸ”ï¸ é›ªå±±</option>
        </select>
        <button id="pbtn" onclick="toggleAudio(event)">â–¶</button>
    </div>

    <audio id="audio" loop src="0.m4a"></audio>

    <script src="rain.js"></script>
    <script>
        const audio = document.getElementById('audio');
        const pbtn = document.getElementById('pbtn');

        // åˆ‡æ¢åœºæ™¯ï¼ˆèƒŒæ™¯å›¾ï¼‰
        function changeScene() {
            const scene = document.getElementById('sceneSelect').value;
            // è¿™é‡Œçš„é€»è¾‘éœ€è¦æ ¹æ®ä½ çš„ rain.js æš´éœ²çš„æ¥å£è°ƒæ•´
            // é€šå¸¸æ˜¯æ›´æ–° renderer é‡Œçš„èƒŒæ™¯çº¹ç†
            document.getElementById('container').style.backgroundImage = `url(${scene})`;
        }

        // åˆ‡æ¢å¤©æ°”æ¨¡å¼ï¼ˆå¯¹åº” rain.js é‡Œçš„ Z å¯¹è±¡ï¼‰
        function changeWeather() {
            const weather = document.getElementById('weatherSelect').value;
            window.location.hash = weather; // è§¦å‘ rain.js é‡Œçš„ hashchange äº‹ä»¶
        }

        // åŸºç¡€äº¤äº’
        function toggleRules(e) {
            e.stopPropagation();
            const card = document.getElementById('mainRule');
            const isOpen = card.style.display === 'block';
            card.style.display = isOpen ? 'none' : 'block';
            e.target.innerText = isOpen ? 'FOCUS MODE' : 'RELEASE';
        }

        function sync() { audio.volume = document.getElementById('vol').value; }
        
        function initAudio() { 
            if(audio.paused) { audio.play(); pbtn.innerText = "â¸"; } 
        }

        function toggleAudio(e) { 
            e.stopPropagation(); 
            audio.paused ? audio.play() : audio.pause(); 
            pbtn.innerText = audio.paused ? "â–¶" : "â¸"; 
        }

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('zh-CN', {hour12: false});
        }

        setInterval(updateClock, 1000);
        updateClock();
    </script>
</body>
</html>
